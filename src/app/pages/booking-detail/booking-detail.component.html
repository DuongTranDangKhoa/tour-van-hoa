

<!-- Ph·∫ßn tr√™n: 100% chi·ªÅu r·ªông v·ªõi h√¨nh ·∫£nh tour -->
<div class="tour-hero-section" *ngIf="tour">
  <div class="media-section">
    <div class="main-image">
      <img [src]="tour.imageUrl" [alt]="tour.name" class="hero-image">
      <button class="play-button">
        <i class="icon">‚ñ∂Ô∏è</i>
      </button>
    </div>
    <div class="image-grid">
      <div class="grid-item">
        <img [src]="tour.imageUrl" [alt]="tour.name">
        <div class="overlay-text">Tour VƒÉn H√≥a presents</div>
      </div>
      <div class="grid-item">
        <img [src]="tour.imageUrl" [alt]="tour.name">
      </div>
      <div class="grid-item">
        <img [src]="tour.imageUrl" [alt]="tour.name">
      </div>
      <div class="grid-item">
        <img [src]="tour.imageUrl" [alt]="tour.name">
        <div class="gallery-btn">
          <i class="icon">üì∑</i>
          <span>Th∆∞ vi·ªán</span>
        </div>
      </div>
    </div>
  </div>
  

</div>

<!-- Ph·∫ßn d∆∞·ªõi: Chia 2 c·ªôt -->
<div class="main-content" *ngIf="tour">
  <!-- Left Panel: Th√¥ng tin tour -->
 
  <div class="tour-details-panel">
     <div class="event-title-section">
    <h1>{{ tour.name }}</h1>
    <div class="rating">
      <i class="icon">‚≠ê</i>
      <i class="icon">‚≠ê</i>
      <i class="icon">‚≠ê</i>
      <i class="icon">‚≠ê</i>
      <i class="icon">‚≠ê</i>
      <span>(4.5)</span>
    </div>
  </div>
    <div class="description-section">
      <h2>M√¥ t·∫£</h2>
      <p>{{ tour.description }}</p>
    </div>

    <div class="general-info-section">
      <h2>Th√¥ng tin chung</h2>
      <ul>
        <li><i class="icon">üìç</i> <strong>ƒêi·ªÉm ƒë·∫øn:</strong> {{ tour.destination }}</li>
        <li><i class="icon">‚è∞</i> <strong>Th·ªùi l∆∞·ª£ng:</strong> {{ tour.duration }}</li>
        <li><i class="icon">üë•</i> <strong>S·ªë ng∆∞·ªùi t·ªëi ƒëa:</strong> {{ tour.maxGroupSize }}</li>
        <li><i class="icon">üí∞</i> <strong>Gi√°:</strong> {{ tour.price | currency:'VND':'symbol':'1.0-0' }}</li>
        <li><i class="icon">üìÖ</i> <strong>Ng√†y kh·ªüi h√†nh:</strong> H√†ng ng√†y</li>
        <li><i class="icon">üåê</i> <strong>Ng√¥n ng·ªØ:</strong> Ti·∫øng Vi·ªát, Ti·∫øng Anh</li>
        <li><i class="icon">‚≠ê</i> <strong>ƒê·ªô kh√≥:</strong> {{ tour.difficulty }}</li>
      </ul>
    </div>

    <div class="programme-section">
      <h2>Ch∆∞∆°ng tr√¨nh tour</h2>
      <p>Chi ti·∫øt ch∆∞∆°ng tr√¨nh tour s·∫Ω ƒë∆∞·ª£c cung c·∫•p khi x√°c nh·∫≠n ƒë·∫∑t ch·ªó.</p>
    </div>
  </div>

  <!-- Right Panel: Booking Widget -->
  <div class="booking-widget">
    <form [formGroup]="bookingForm" (ngSubmit)="onBookTour()">
      <!-- Customer Information Section -->
      <div class="customer-info-section">
        <h4>Th√¥ng tin kh√°ch h√†ng</h4>

        <div class="form-row">
          <div class="form-group">
            <label for="customerName">H·ªç v√† t√™n *</label>
            <input
              type="text"
              id="customerName"
              formControlName="customerName"
              placeholder="Nh·∫≠p h·ªç v√† t√™n"
              [class.error]="isFieldInvalid('customerName')"
            >
            <div class="error-message" *ngIf="isFieldInvalid('customerName')">
              {{ getFieldError('customerName') }}
            </div>
          </div>

          <div class="form-group">
            <label for="customerEmail">Email *</label>
            <input
              type="email"
              id="customerEmail"
              formControlName="customerEmail"
              placeholder="Nh·∫≠p email"
              [class.error]="isFieldInvalid('customerEmail')"
            >
            <div class="error-message" *ngIf="isFieldInvalid('customerEmail')">
              {{ getFieldError('customerEmail') }}
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="customerPhone">S·ªë ƒëi·ªán tho·∫°i *</label>
            <input
              type="tel"
              id="customerPhone"
              formControlName="customerPhone"
              placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i"
              [class.error]="isFieldInvalid('customerPhone')"
            >
            <div class="error-message" *ngIf="isFieldInvalid('customerPhone')">
              {{ getFieldError('customerPhone') }}
            </div>
          </div>

          <div class="form-group">
            <label for="customerIdCard">S·ªë CMND/CCCD</label>
            <input
              type="text"
              id="customerIdCard"
              formControlName="customerIdCard"
              placeholder="Nh·∫≠p s·ªë CMND/CCCD"
            >
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="customerDateOfBirth">Ng√†y sinh</label>
            <input
              type="date"
              id="customerDateOfBirth"
              formControlName="customerDateOfBirth"
            >
          </div>

          <div class="form-group">
            <label for="customerGender">Gi·ªõi t√≠nh</label>
            <select id="customerGender" formControlName="customerGender">
              <option value="">Ch·ªçn gi·ªõi t√≠nh</option>
              <option value="male">Nam</option>
              <option value="female">N·ªØ</option>
              <option value="other">Kh√°c</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="customerAddress">ƒê·ªãa ch·ªâ</label>
          <textarea
            id="customerAddress"
            formControlName="customerAddress"
            placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ c·ªßa b·∫°n"
          ></textarea>
        </div>
      </div>

      <!-- Tour Details Section -->
      <div class="tour-details-section">
        <h4>Chi ti·∫øt ƒë·∫∑t tour</h4>

        <div class="form-row">
          <div class="form-group">
            <label for="numberOfPeople">S·ªë ng∆∞·ªùi *</label>
            <div class="quantity-controls">
              <button type="button" (click)="decreaseQuantity()" class="quantity-btn">-</button>
              <span class="quantity-display">{{ bookingForm.get('numberOfPeople')?.value || 1 }} ng∆∞·ªùi</span>
              <button type="button" (click)="increaseQuantity()" class="quantity-btn">+</button>
            </div>
            <div class="error-message" *ngIf="isFieldInvalid('numberOfPeople')">
              {{ getFieldError('numberOfPeople') }}
            </div>
          </div>

          <div class="form-group">
            <label for="paymentMethod">Ph∆∞∆°ng th·ª©c thanh to√°n *</label>
            <select id="paymentMethod" formControlName="paymentMethod">
              <option value="bank_transfer">Chuy·ªÉn kho·∫£n ng√¢n h√†ng</option>
              <option value="credit_card">Th·∫ª t√≠n d·ª•ng</option>
              <option value="cash">Ti·ªÅn m·∫∑t</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="departureDate">Ng√†y kh·ªüi h√†nh *</label>
            <input
              type="date"
              id="departureDate"
              formControlName="departureDate"
              [class.error]="isFieldInvalid('departureDate')"
            >
            <div class="error-message" *ngIf="isFieldInvalid('departureDate')">
              {{ getFieldError('departureDate') }}
            </div>
          </div>

          <div class="form-group">
            <label for="returnDate">Ng√†y k·∫øt th√∫c *</label>
            <input
              type="date"
              id="returnDate"
              formControlName="returnDate"
              [class.error]="isFieldInvalid('returnDate')"
            >
            <div class="error-message" *ngIf="isFieldInvalid('returnDate')">
              {{ getFieldError('returnDate') }}
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="specialRequests">Y√™u c·∫ßu ƒë·∫∑c bi·ªát</label>
          <textarea
            id="specialRequests"
            formControlName="specialRequests"
            placeholder="V√≠ d·ª•: y√™u c·∫ßu ƒÉn chay, h·ªó tr·ª£ xe lƒÉn..."
          ></textarea>
        </div>
      </div>

      <!-- Emergency Contact Section -->
      <div class="emergency-contact-section">
        <h4>Th√¥ng tin li√™n h·ªá kh·∫©n c·∫•p</h4>

        <div class="form-row">
          <div class="form-group">
            <label for="emergencyContactName">H·ªç v√† t√™n</label>
            <input
              type="text"
              id="emergencyContactName"
              formControlName="emergencyContactName"
              placeholder="T√™n ng∆∞·ªùi li√™n h·ªá kh·∫©n c·∫•p"
            >
          </div>

          <div class="form-group">
            <label for="emergencyContactPhone">S·ªë ƒëi·ªán tho·∫°i</label>
            <input
              type="tel"
              id="emergencyContactPhone"
              formControlName="emergencyContactPhone"
              placeholder="S·ªë ƒëi·ªán tho·∫°i ng∆∞·ªùi li√™n h·ªá kh·∫©n c·∫•p"
            >
          </div>
        </div>

        <div class="form-group">
          <label for="emergencyContactRelationship">M·ªëi quan h·ªá</label>
          <input
            type="text"
            id="emergencyContactRelationship"
            formControlName="emergencyContactRelationship"
            placeholder="V√≠ d·ª•: B·ªë, M·∫π, Anh, Ch·ªã..."
          >
        </div>
      </div>

      <!-- Tour Summary -->
      <div class="tour-summary">
        <h4>Th√¥ng tin tour v√† thanh to√°n</h4>
        <div class="summary-item">
          <span>Tour:</span>
          <span>{{ tour.name }}</span>
        </div>
        <div class="summary-item">
          <span>ƒêi·ªÉm ƒë·∫øn:</span>
          <span>{{ tour.destination }}</span>
        </div>
        <div class="summary-item">
          <span>Th·ªùi gian:</span>
          <span>{{ tour.duration }}</span>
        </div>
        <div class="summary-item">
          <span>Gi√° g·ªëc:</span>
          <span>{{ tour.price | currency:'VND':'symbol':'1.0-0' }}/ng∆∞·ªùi</span>
        </div>
        <div class="summary-item">
          <span>S·ªë ng∆∞·ªùi:</span>
          <span>{{ bookingForm.get('numberOfPeople')?.value || 1 }}</span>
        </div>
        <div class="summary-item">
          <span>T·ªïng ti·ªÅn:</span>
          <span>{{ getTotalPrice() | currency:'VND':'symbol':'1.0-0' }}</span>
        </div>
        <div class="summary-item">
          <span>ƒê·∫∑t c·ªçc (20%):</span>
          <span>{{ getDepositAmount() | currency:'VND':'symbol':'1.0-0' }}</span>
        </div>
        <div class="summary-item total">
          <span>C√≤n l·∫°i:</span>
          <span>{{ getRemainingAmount() | currency:'VND':'symbol':'1.0-0' }}</span>
        </div>
      </div>

      <!-- Submit Button -->
      <button type="submit" class="book-button" [disabled]="bookingForm.invalid || isSubmitting">
        <span *ngIf="!isSubmitting">
          {{ getTotalPrice() | currency:'VND':'symbol':'1.0-0' }} ‚Äî Ti·∫øp t·ª•c
        </span>
        <span *ngIf="isSubmitting">
          <i class="loading-spinner">‚è≥</i> ƒêang x·ª≠ l√Ω...
        </span>
      </button>
    </form>
  </div>
</div>
