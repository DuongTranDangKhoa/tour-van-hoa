<div class="booking-detail-page">
  <!-- Top Section: Tour Images -->
  <div class="tour-hero-section" *ngIf="tour" (click)="openImageGallery()">
    <div class="media-section">
      <!-- Left section - 50% -->
      <div class="main-image-section">
        <img [src]="tour.imageUrl" [alt]="tour.name" title="Tour image" class="hero-image">
        <button class="play-button">
          <i class="icon">▶️</i>
        </button>
      </div>
      
      <!-- Right section - 50% divided into 4 equal parts -->
      <div class="image-grid-section">
        <div class="grid-item">
          <img [src]="tour.imageUrl" [alt]="tour.name" title="Tour image">
          <div class="overlay-text">Tour Van Hoa presents</div>
        </div>
        <div class="grid-item top-right-border">
          <img [src]="tour.imageUrl" [alt]="tour.name" title="Tour image">
        </div>
        <div class="grid-item">
          <img [src]="tour.imageUrl" [alt]="tour.name" title="Tour image">
        </div>
        <div class="grid-item bot-right-border">
          <img [src]="tour.imageUrl" [alt]="tour.name" title="Tour image">
          <div class="gallery-btn">
            <i class="icon">📷</i>
            <span>Thư viện</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Phần dưới: Chia 2 cột -->
  <div class="main-content" *ngIf="tour">
          <!-- Left Panel: Tour Information -->
    <div class="tour-details-panel">
      <div class="event-title-section">
        <h1>{{ tour.name }}</h1>
        <div class="rating">
          <i class="icon">⭐</i>
          <i class="icon">⭐</i>
          <i class="icon">⭐</i>
          <i class="icon">⭐</i>
          <i class="icon">⭐</i>
          <span>(4.5)</span>
        </div>
      </div>
                        <div class="description-section">
          <h2>Description</h2>
          <div class="description-content">
            <div class="intro-section">
              <h3>Intro Description</h3>
              <p>⭐ Step into the heart of Vietnam with the Vietnam Art & Culture Tour by This Is Home — an immersive cultural journey designed to connect you with the country's authentic heritage. From traditional craft workshops to wandering the lantern-lit streets of Hoi An, every moment reveals the timeless beauty of Vietnam's traditions. Guided by passionate locals, this full-day adventure blends creativity, cuisine, and community, leaving you with unforgettable memories of Vietnam's soul.</p>
            </div>
            
            <div class="highlights-section">
              <h3>Highlights</h3>
              <div class="highlights-list">
                <p>🌏 Authentic cultural immersion with local artisans.</p>
                <p>☕ Hands-on coffee brewing workshop at Hush Workspace.</p>
                <p>🏺 Pottery-making at Le Duc Ha Terra Cotta Studio, including lunch.</p>
                <p>🪵 Wood carving workshop at Au Lac with master artisans.</p>
                <p>🏮 Explore the enchanting lantern-lit Hoi An Ancient Town.</p>
                <p>🏖️ Relax and discover Vietnam's stunning beaches.</p>
                <p>🍲 Savor authentic local cuisine, rich in flavor.</p>
                <p>🎁 Receive a special keepsake gift set from This Is Home.</p>
              </div>
            </div>
            
            <div class="general-info-section">
              <h3>General Info</h3>
              <div class="general-info-list">
                <p>📅 Date & Time: Departure at 08:45 AM – Return at 5:30 PM (full-day tour).</p>
                <p>⏳ Duration: Approx. 9 hours.</p>
                <p>📍 Location: Hotel/office pick-up & drop-off in the Da Nang – Hoi An area.</p>
                <p>👥 Age requirement: Suitable for all ages; children under 16 must be accompanied by an adult.</p>
                <p>🚐 Transportation: Private coach (7-seater or 16-seater), air-conditioned.</p>
                <p>💰 Pricing:</p>
                <p class="pricing-detail">Package 1: 7-seater – $307/tour | 16-seater – $635/tour.</p>
                <p class="pricing-detail">Package 2: 7-seater – $42/tour | 16-seater – $35/tour.</p>
                <p class="pricing-detail">Full program: SGD $296 per person (excludes international flights).</p>
                <p>🏨 Accommodation (multi-day option): 3–4 star hotels, double rooms (single available upon request), with Wi-Fi & TV.</p>
                <p>🍴 Meals included: Hotel breakfast, 4 lunches, 3 dinners (including Welcome Dinner & Gala Dinner).</p>
                <p>🦽 Accessibility: Wheelchair-friendly venues.</p>
                <p>📌 Included: Entrance fees, English-speaking guides, all workshops, transportation, meals, and gift set.</p>
                <p>❌ Not included: Personal expenses, shopping, phone calls, additional drinks/meals, international flights.</p>
                <p>📲 Booking & Contact:</p>
                <p class="contact-detail">Website: tih.nhi.sg</p>
                <p class="contact-detail">Email: danh&#64;nhi.sg</p>
                <p class="contact-detail">WhatsApp: +84 367666618</p>
              </div>
            </div>
            
            <div class="full-description-section">
              <h3>Full Description</h3>
              <p>✨ This Is Home brings you a cultural journey to remember through Central Vietnam. Guided by local artisans, you'll learn the art of coffee brewing, pottery, and wood carving. Then, stroll through the vibrant lantern-lit alleys of Hoi An Ancient Town, savor local cuisine, and unwind at breathtaking beaches.</p>
              <p>Every experience is designed to connect you deeply with Vietnam's heritage — from creative workshops to heartwarming meals and meaningful keepsakes. With accommodation, transport, guides, and meals fully included, all you need to do is immerse yourself.</p>
              <p>🌿 Whether you're a culture enthusiast, a family seeking meaningful bonding, or a traveler craving authentic encounters — this tour promises lasting memories of Vietnam's soul.</p>
            </div>
          </div>
        </div> 
      <div class="user-photo-gallery">
        <h2>User Photo Gallery</h2>
        <div class="photo-grid" (click)="openImageGallery()">
          <div class="photo-item">
            <img src="assets/minecraft-experience.jpg" alt="Minecraft Experience Screen">
            <div class="photo-overlay">
              <span class="photo-title">Minecraft Experience</span>
            </div>
          </div>
          <div class="photo-item">
            <img src="assets/minecraft-bee.jpg" alt="Minecraft Bee Statue">
            <div class="photo-overlay">
              <span class="photo-title">Minecraft Bee</span>
            </div>
          </div>
          <div class="photo-item">
            <img src="assets/minecraft-creeper.jpg" alt="Boy on Creeper Statue">
            <div class="photo-overlay">
              <span class="photo-title">Creeper Adventure</span>
            </div>
          </div>
          <div class="photo-item">
            <img src="assets/minecraft-structure.jpg" alt="Minecraft Blue Structure">
            <div class="photo-overlay">
              <span class="photo-title">Mysterious Structure</span>
            </div>
          </div>
        </div>
      </div>

      <div class="user-reviews-section" >
        <h2>User reviews</h2>
        <div class="reviews-header">
          <div class="score">
            <span class="score-value">4.8</span><span class="score-out-of">/5</span>
          </div>
          <div class="stars" aria-label="rating 5 stars">
            <i class="star">★</i>
            <i class="star">★</i>
            <i class="star">★</i>
            <i class="star">★</i>
            <i class="star">★</i>
          </div>
          <div class="based-on">based on 29 reviews</div>
        </div>

        <div class="reviews-list">
          <div class="review-card">
            <div class="review-card-header">
              <div class="reviewer">Maechel D.</div>
              <div class="date">Jul 2025</div>
              <div class="stars small">
                <i>★</i><i>★</i><i>★</i><i>★</i><i>★</i>
              </div>
            </div>
            <div class="review-text">
              Its magical and really breathless. The musical had really enjoying music, hope the time is more than one hour..
            </div>
          </div>

          <div class="review-card">
            <div class="review-card-header">
              <div class="reviewer">Alexandr...</div>
              <div class="date">Jul 2025</div>
              <div class="stars small">
                <i>★</i><i>★</i><i>★</i><i>★</i><i>★</i>
              </div>
            </div>
            <div class="review-text">
              Very good and well organized. Great place and good music always match well.
            </div>
          </div>

          <div class="review-card">
            <div class="review-card-header">
              <div class="reviewer">Jun 2025</div>
              <div class="date">—</div>
              <div class="stars small">
                <i>★</i><i>★</i><i>★</i><i>★</i><i>★</i>
              </div>
            </div>
            <div class="review-text">
              It was one of the most beautiful string concerts that I have ever gone to.
            </div>
          </div>
        </div>

        <div class="reviews-actions">
          <button type="button" class="view-all">View all reviews</button>
        </div>
      </div>
      <div class="map-and-info-section">
        <!-- Left Column: Info Sections -->
        <div class="info-column">
          <!-- Need Help Section -->
          <div class="help-section">
            <div class="info-header">
              <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="11" stroke="#333" stroke-width="1.5" fill="none"/>
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" stroke="#333" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="12" cy="17" r="1" fill="#333"/>
              </svg>
              <div class="info-content">
                <h3>Need help?</h3>
                <p>Contact Support <a href="#" class="link">here</a></p>
              </div>
            </div>
          </div>

          <!-- Getting There Section -->
          <div class="getting-there-section">
            <div class="info-header">
              <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <!-- Base -->
                <rect x="2" y="18" width="20" height="4" fill="#333"/>
                <!-- Columns -->
                <rect x="3" y="8" width="2" height="10" stroke="#333" stroke-width="1.5" fill="none"/>
                <rect x="7" y="8" width="2" height="10" stroke="#333" stroke-width="1.5" fill="none"/>
                <rect x="15" y="8" width="2" height="10" stroke="#333" stroke-width="1.5" fill="none"/>
                <rect x="19" y="8" width="2" height="10" stroke="#333" stroke-width="1.5" fill="none"/>
                <!-- Entablature -->
                <rect x="2" y="8" width="20" height="2" fill="#333"/>
                <!-- Roof/Pediment -->
                <path d="M2 8 L12 2 L22 8" stroke="#333" stroke-width="1.5" fill="none"/>
                <!-- Arch in pediment -->
                <path d="M8 6 Q12 4 16 6" stroke="#333" stroke-width="1" fill="none"/>
              </svg>
              <div class="info-content">
                <h3>About the venue</h3>
                <p class="address">
                  <span class="unit">Unit 20 Fulton Road</span><br>
                  Fulton Road Industrial Units 22-28, Wembley Park, Wembley, HA9 0NP, HA9 0NP
                </p>
                <div class="location-tags">
                  <span class="tag grey"></span>
                  <span class="tag purple"></span>
                  <span class="location-name">Wembley Park</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Column: Google Map -->
        <div class="map-column">
          <div class="map-embed">
            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d236225.41396791287!2d103.74160180208737!3d22.315004187869228!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x36cd40a503ec6395%3A0x49032814dedb2fb8!2zU2EgUGEsIEzDoG8gQ2FpLCBWaeG7h3QgTmFt!5e0!3m2!1svi!2s!4v1755762959879!5m2!1svi!2s" width="100%" height="400" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
          </div>
        </div>
      </div>
      
    </div>

    <!-- Right Panel: Booking Widget - feverup style -->
    <div class="booking-widget">
      <form [formGroup]="bookingForm" (ngSubmit)="onBookTour()">
        <!-- Calendar Section -->
        <div class="calendar-section">
          <h3>Chọn ngày và giờ</h3>
          <div class="month-nav">
            <button type="button" (click)="prevMonth()" class="nav-btn" [disabled]="!canGoPrevMonth()">‹</button>
            
            <!-- Hiển thị 3 tháng -->
            <div class="month-buttons">
              <button type="button" 
                      *ngFor="let month of getVisibleMonths(); let i = index"
                      (click)="selectMonth(month.value, month.year)" 
                      [class.active]="month.value === currentMonth && month.year === currentYear"
                      class="month-btn">
                {{ month.label }}
              </button>
            </div>
            
            <button type="button" (click)="nextMonth()" class="nav-btn" [disabled]="!canGoNextMonth()">›</button>
          </div>

          <div class="weekdays">
            <div class="day">SU</div>
            <div class="day">MO</div>
            <div class="day">TU</div>
            <div class="day">WE</div>
            <div class="day">TH</div>
            <div class="day">FR</div>
            <div class="day">SA</div>
          </div>

          <div class="calendar-days">
            <div class="day-cell" *ngFor="let day of days" 
                 [class.selected]="day.selected"
                 [class.low-availability]="day.availability === 'low'"
                 [class.best-price]="day.availability === 'best'"
                 [class.empty]="!day.day"
                 [class.disabled]="day.disabled"
                 (click)="selectDate(day)">
              <div class="corner-ribbon" *ngIf="day.selected"></div>
              <div class="day-number">{{ day.day }}</div>
              <!-- <div class="day-price" *ngIf="day.day && !day.disabled">${{ day.price }}</div> -->
              <div class="bottom-indicator"></div>
            </div>
          </div>

          <!-- Session Selection -->
                      <div class="session-selection">
              <div class="session-header">
                <div class="currency-note">All prices shown in British pounds</div>
                <div class="legend">
                  <div class="legend-item">
                    <span class="legend-line low"></span>
                    <span class="legend-text">Low availability</span>
                  </div>
                  <div class="legend-item">
                    <span class="legend-line best"></span>
                    <span class="legend-text">Best price</span>
                  </div>
                </div>
              </div>
            <div class="session-navigation">
              <button type="button" 
                      class="nav-btn" 
                      (click)="prevSession()" 
                      [disabled]="!canGoPrevSession()">
                ‹
              </button>
              
              <div class="session-buttons">
                <button type="button" 
                        class="session-btn" 
                        *ngFor="let session of getVisibleSessions()"
                        (click)="selectSession(session)"
                        [class.active]="selectedSession === session">
                  {{ session }}
                </button>
              </div>
              
              <button type="button" 
                      class="nav-btn" 
                      (click)="nextSession()" 
                      [disabled]="!canGoNextSession()">
                ›
              </button>
            </div>
          </div>
        </div>

        <!-- Ticket Selection -->
        <div class="ticket-selection">
          <div class="ticket-item" *ngFor="let ticket of tickets">
            <div class="ticket-left">
              <div class="ticket-header">
                <h4>{{ ticket.name }}</h4>
             
              </div>
              <div class="ticket-desc">
                <button type="button" class="more-info-btn" (click)="toggleTicketInfo(ticket.id)">
                  {{ isTicketInfoVisible(ticket.id) ? 'Less info' : 'More info' }}
                </button>
                <div class="ticket-details" *ngIf="isTicketInfoVisible(ticket.id)">
                  <p>Ticket includes:</p>
                  <ul *ngIf="ticket.id === 'adult'">
                    <li>Shared coach, fixed itinerary</li>
                    <li>Arrival at the departure point before the tour starts</li>
                  </ul>
                  <ul *ngIf="ticket.id === 'child'">
                    <li>Must be accompanied by an adult</li>
                    <li>Shared coach, fixed itinerary</li>
                    <li>Arrival at the departure point before the tour starts</li>
                  </ul>
                  <ul *ngIf="ticket.id === 'small-group'">
                    <li></li>
                    <li>For groups of 3–5 guests</li>
                    <li>Private vehicle with hotel pick-up & drop-offted activities</li>
                    <li>Flexible itinerary: option to adjust or replace selected activities.</li>
                  </ul>
                  <ul *ngIf="ticket.id === 'large-group'">
                    <li>For groups of 6–14 guests</li>
                    <li>Private vehicle with hotel pick-up & drop-off</li>
                    <li>Customizable itinerary tailored to group preferences</li>
                  </ul>
                </div>
              </div>
              <div class="ticket-price">
                <span class="price">{{ ticket.price | currency:'USD':'symbol':'1.2-2' }}</span>
                <span class="fee" *ngIf="ticket.bookingFee > 0">+ {{ ticket.bookingFee | currency:'USD':'symbol':'1.2-2' }} booking fee</span>
              </div>
            </div>
            <div class="ticket-right">
              <div class="quantity-selector">
                <button type="button" (click)="adjustQuantity(ticket.id, -1)" [disabled]="getTicketQuantity(ticket.id) === 0">−</button>
                <span>{{ getTicketQuantity(ticket.id) }}</span>
                <button type="button" (click)="adjustQuantity(ticket.id, 1)">+</button>
              </div>
            </div>
          </div>
    

          <!-- Total Price -->
          <div class="total-price">
            <span>Total:</span>
            <span class="amount">{{ getTotalPrice() | currency:'USD':'symbol':'1.2-2' }}</span>
          </div>

          <!-- Submit Button -->
          <button type="submit" class="book-button" [disabled]="isSubmitting || !selectedDate || !selectedSession">
            {{ getTotalPrice() | currency:'USD':'symbol':'1.2-2' }} — Book Now
          </button>
        </div>
      </form>
    </div>
  </div>
</div>