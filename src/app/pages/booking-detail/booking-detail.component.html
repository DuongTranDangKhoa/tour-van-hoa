<div class="booking-detail-page" (window:scroll)="onScroll()">
  <!-- Top Section: Tour Images -->
  <div class="tour-hero-section" *ngIf="tour" (click)="openImageGallery()">
    <div class="media-section">
      <!-- Left section - 50% -->
      <div class="main-image-section">
        <img src="/city-image/TRUONG_6M0A2586.jpg" [alt]="tour.name" title="Tour image" class="hero-image">
      </div>
      
      <!-- Right section - 50% divided into 4 equal parts -->
      <div class="image-grid-section">
        <div class="grid-item">
          <img src="/city-image/6M0A2532.JPG" [alt]="tour.name" title="Tour image">
          <div class="overlay-text">Tour Van Hoa presents</div>
        </div>
        <div class="grid-item top-right-border">
          <img src="/city-image/6M0A0688.JPG" [alt]="tour.name" title="Tour image">
        </div>
        <div class="grid-item">
          <img src="/city-image/6M0A0599.JPG" [alt]="tour.name" title="Tour image">
        </div>
        <div class="grid-item bot-right-border">
          <img src="/city-image/6M0A0493.JPG" [alt]="tour.name" title="Tour image">
          <div class="gallery-btn">
            <i class="icon">ğŸ“·</i>
            <span>ThÆ° viá»‡n</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Pháº§n dÆ°á»›i: Chia 2 cá»™t -->
  <div class="main-content" *ngIf="tour">
          <!-- Left Panel: Tour Information -->
    <div class="tour-details-panel">
      <div class="event-title-section">
        <h1>{{ tour.name }}</h1>
        <div class="rating">
          <i class="icon">â­</i>
          <i class="icon">â­</i>
          <i class="icon">â­</i>
          <i class="icon">â­</i>
          <i class="icon">â­</i>
          <span>(4.5)</span>
        </div>
      </div>
                        <div class="description-section">
          <h2>Description</h2>
          <div class="description-content">
            <div class="intro-section">
              <h3>Intro Description</h3>
              <p class="description-text">âœ¨ Step into the heart of Central Vietnam with the Vietnam Art & Culture Tour by This Is Home â€” a full-day cultural journey designed to connect you with the countryâ€™s authentic heritage. From hands-on craft workshops to exploring the Cham Towers, every moment reveals the timeless beauty of Vietnamâ€™s traditions. Guided by passionate locals, this immersive adventure blends creativity, cuisine, and community, leaving you with unforgettable memories of Vietnamâ€™s soul.
              </p>
            </div>
            
            <div class="highlights-section">
              <h3>Highlights</h3>
              <div class="highlights-list">
                <p>ğŸŒ¿ Authentic cultural immersion with local artisans.</p>
                <p>ğŸº Pottery-making at LÃª Äá»©c Háº¡ Pottery Village, including your own handmade souvenir.</p>
                <p>â˜• Hands-on coffee brewing workshop at Hush Coffee Workspace.</p>
                <p>ğŸªµ Wood carving experience at Ã‚u Láº¡c Workshop with master artisans.</p>
                <p>ğŸ² Savor authentic Vietnamese cuisine with a traditional lunch.</p>
                <p>ğŸ› Explore the Cham Towers, learning about the Champa Kingdomâ€™s art, history, and architecture.</p>
                <p>ğŸ Take home a cultural keepsake from your craft experience.</p>
              </div>
            </div>
            
            <div class="general-info-section">
              <h3>General Info</h3>
              <div class="general-info-list">
                <p>ğŸ“… Departure at 08:00 AM â€“ Return at 6:00 PM (full-day tour, approx. 10 hours).</p>
                <p>ğŸ“ Location: Pick-up & drop-off in ÄÃ  Náºµng</p>
                <p>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Age requirement: Suitable for all ages; children under 12 must be accompanied by an adult.</p>
                <p>ğŸšŒ Transportation: Private coach (7-seater or 16-seater), air-conditioned.</p>
                <p style="font-size: 18px; font-weight: 600; color: #000000; margin-bottom: 12px;">ğŸ’° Pricing Options (4 ticket types):</p>
                <p class="pricing-detail">Shared 7: $37/person (7-seater, up to 5 pax, shared with others, fixed meeting point).</p>
                <p class="pricing-detail">Shared 16: $37/person (16-seater, up to 14 pax, shared with others, fixed meeting point).</p>
                <p class="pricing-detail">Private 7: $305/tour (7-seater, up to 5 pax, hotel pick-up, private group).</p>
                <p class="pricing-detail">Private 16: $629/tour (16-seater, up to 14 pax, hotel pick-up, private group).</p>
                <p>ğŸ½ Meals included: 1 traditional Vietnamese lunch.</p>
                <p>ğŸ¨ Accommodation: Not included (day tour only).</p>
                <p>â™¿ Accessibility: Wheelchair-friendly venues.</p>
                <p>âœ… Included: Entrance fees, English-speaking guides, all workshops, transportation, lunch, and keepsake.</p>
                <p>âŒ Not included: Personal expenses, shopping, phone calls, additional drinks/meals, international flights.</p>
                <p>ğŸ“² Booking & Contact:</p>
                <p class="contact-detail">Website: tih.nhi.sg</p>
                <p class="contact-detail">Email: danh&#64;nhi.sg</p>
                <p class="contact-detail">WhatsApp: +84 367666618</p>
              </div>
            </div>
            
            <div class="full-description-section">
              <h3>Full Description</h3>
              <p>ğŸŒ¸ This Is Home brings you a cultural journey to remember through Central Vietnam. Guided by local artisans and cultural experts, you'll experience:</p>
              <li>Pottery-making at LÃª Äá»©c Háº¡ Village, where Cham traditions meet Vietnamese craft.</li>
              <li>A hands-on coffee workshop at Hush Workspace, discovering the cultural roots of Vietnam's coffee heritage.</li>
              <li>Wood carving at Ã‚u Láº¡c Workshop, learning how traditional art reflects history and spirituality.</li>
              <li>A visit to the Cham Towers in ÄÃ  Náºµng, where the architecture, art, and stories of the Champa Kingdom come alive.</li>
              <p>Along the way, enjoy a traditional Vietnamese lunch and take home a meaningful keepsake from your own craftwork.</p>
              <p>ğŸŒ± Whether you're a culture enthusiast, a family seeking meaningful bonding, or a traveler craving authentic encounters â€” this tour promises lasting memories of Vietnam's heritage and soul.</p>
            </div>
          </div>
        </div> 
   

      <div class="user-reviews-section" >
        <h2>User reviews</h2>
        <div class="reviews-header">
          <div class="score">
            <span class="score-value">4.8</span><span class="score-out-of">/5</span>
          </div>
          <div class="stars" aria-label="rating 5 stars">
            <i class="star">â˜…</i>
            <i class="star">â˜…</i>
            <i class="star">â˜…</i>
            <i class="star">â˜…</i>
            <i class="star">â˜…</i>
          </div>
          <div class="based-on">based on 29 reviews</div>
        </div>

        <div class="reviews-list">
          <div class="review-card">
            <div class="review-card-header">
              <div class="reviewer">Maechel D.</div>
              <div class="date">Jul 2025</div>
              <div class="stars small">
                <i>â˜…</i><i>â˜…</i><i>â˜…</i><i>â˜…</i><i>â˜…</i>
              </div>
            </div>
            <div class="review-text">
              Its magical and really breathless. The musical had really enjoying music, hope the time is more than one hour..
            </div>
          </div>

          <div class="review-card">
            <div class="review-card-header">
              <div class="reviewer">Alexandr...</div>
              <div class="date">Jul 2025</div>
              <div class="stars small">
                <i>â˜…</i><i>â˜…</i><i>â˜…</i><i>â˜…</i><i>â˜…</i>
              </div>
            </div>
            <div class="review-text">
              Very good and well organized. Great place and good music always match well.
            </div>
          </div>

          <div class="review-card">
            <div class="review-card-header">
              <div class="reviewer">Jun 2025</div>
              <div class="date">â€”</div>
              <div class="stars small">
                <i>â˜…</i><i>â˜…</i><i>â˜…</i><i>â˜…</i><i>â˜…</i>
              </div>
            </div>
            <div class="review-text">
              It was one of the most beautiful string concerts that I have ever gone to.
            </div>
          </div>
        </div>

        <div class="reviews-actions">
          <button type="button" class="view-all">View all reviews</button>
        </div>
      </div>
      <div class="map-and-info-section">
        <!-- Getting There Section with Map inline -->
        <div class="getting-there-section">
          <div class="info-header">
            <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <!-- Base -->
              <rect x="2" y="18" width="20" height="4" fill="#333"/>
              <!-- Columns -->
              <rect x="3" y="8" width="2" height="10" stroke="#333" stroke-width="1.5" fill="none"/>
              <rect x="7" y="8" width="2" height="10" stroke="#333" stroke-width="1.5" fill="none"/>
              <rect x="15" y="8" width="2" height="10" stroke="#333" stroke-width="1.5" fill="none"/>
              <rect x="19" y="8" width="2" height="10" stroke="#333" stroke-width="1.5" fill="none"/>
              <!-- Entablature -->
              <rect x="2" y="8" width="20" height="2" fill="#333"/>
              <!-- Roof/Pediment -->
              <path d="M2 8 L12 2 L22 8" stroke="#333" stroke-width="1.5" fill="none"/>
              <!-- Arch in pediment -->
              <path d="M8 6 Q12 4 16 6" stroke="#333" stroke-width="1" fill="none"/>
            </svg>
            <div class="info-content">
              <h3>About the venue</h3>
              <div class="address-map-row">
                <div class="address-info">
                  <p class="address">
                    <span class="unit">VÄƒn PhÃ²ng NLT</span><br>
                    74 Náº¡i Nam, HoÃ  CÆ°á»ng Báº¯c, Háº£i ChÃ¢u, ÄÃ  Náºµng, Viá»‡t Nam
                  </p>
                </div>
                <div class="inline-map">
                  <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15338.392387180242!2d108.21975054258819!3d16.034423854237787!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x314219e4227c6aff%3A0xbbf3782d64ef714e!2zNzQgTuG6oWkgTmFtLCBIb8OgIEPGsOG7nW5nIELhuq9jLCBI4bqjaSBDaMOidSwgxJDDoCBO4bq1bmcsIFZp4buHdCBOYW0!5e0!3m2!1svi!2s!4v1756173936637!5m2!1svi!2s" width="200" height="150" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Need Help Section -->
        <div class="help-section">
          <div class="info-header">
            <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="11" stroke="#333" stroke-width="1.5" fill="none"/>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" stroke="#333" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="12" cy="17" r="1" fill="#333"/>
            </svg>
            <div class="info-content">
              <h3>Need help?</h3>
              <p>Contact Support <a href="#" class="link">here</a></p>
            </div>
          </div>
        </div>
      </div>
         <div class="user-photo-gallery">
        <h2>User Photo Gallery</h2>
        <div class="photo-grid" (click)="openImageGallery()">
          <div class="photo-item">
            <img src="/city-image/6M0A2901.JPG" alt="Minecraft Experience Screen">
            <div class="photo-overlay">
              <span class="photo-title">Minecraft Experience</span>
            </div>
          </div>
          <div class="photo-item">
            <img src="/city-image/6M0A2900.JPG" alt="Minecraft Bee Statue">
            <div class="photo-overlay">
              <span class="photo-title">Minecraft Bee</span>
            </div>
          </div>
          <div class="photo-item">
            <img src="/city-image/6M0A0646.JPG" alt="Boy on Creeper Statue">
            <div class="photo-overlay">
              <span class="photo-title">Creeper Adventure</span>
            </div>
          </div>
          <div class="photo-item">
            <img src="/city-image/6M0A0529.JPG" alt="Minecraft Blue Structure">
            <div class="photo-overlay">
              <span class="photo-title">Mysterious Structure</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Panel: Booking Widget and Notification -->
    <div class="booking-section">
      <!-- Booking Widget -->
      <div class="booking-widget">
        <form [formGroup]="bookingForm" (ngSubmit)="onBookTour()">
          <!-- Calendar Section -->
          <div class="calendar-section">
            <h3>Select date and time</h3>
            <div class="month-nav">
              <button type="button" (click)="prevMonth()" class="nav-btn" [disabled]="!canGoPrevMonth()">â€¹</button>
              
              <!-- Hiá»ƒn thá»‹ 3 thÃ¡ng -->
              <div class="month-buttons">
                <button type="button" 
                        *ngFor="let month of getVisibleMonths(); let i = index"
                        (click)="selectMonth(month.value, month.year)" 
                        [class.active]="month.value === currentMonth && month.year === currentYear"
                        class="month-btn">
                  {{ month.label }}
                </button>
              </div>
              
              <button type="button" (click)="nextMonth()" class="nav-btn" [disabled]="!canGoNextMonth()">â€º</button>
            </div>

            <div class="weekdays">
              <div class="day">SU</div>
              <div class="day">MO</div>
              <div class="day">TU</div>
              <div class="day">WE</div>
              <div class="day">TH</div>
              <div class="day">FR</div>
              <div class="day">SA</div>
            </div>

            <div class="calendar-days">
              <div class="day-cell" *ngFor="let day of days" 
                   [class.selected]="day.selected"
                   [class.low-availability]="day.availability === 'low'"
                   [class.best-price]="day.availability === 'best'"
                   [class.empty]="!day.day"
                   [class.disabled]="day.disabled"
                   (click)="selectDate(day)">
                <div class="corner-ribbon" *ngIf="day.selected"></div>
                <div class="day-number">{{ day.day }}</div>
                <!-- <div class="day-price" *ngIf="day.day && !day.disabled">${{ day.price }}</div> -->
                <!-- <div class="bottom-indicator"></div> -->
              </div>
            </div>

            <!-- Divider between calendar and session selection -->
            <div class="calendar-session-divider">
              <div class="divider-line"></div>
              <span class="divider-text">Select time</span>
              <div class="divider-line"></div>
            </div>

            <!-- Session Selection -->
            <div class="session-selection">
                <!-- <div class="session-header">
                  <div class="currency-note">All prices shown in British pounds</div>
                  <div class="legend">
                    <div class="legend-item">
                      <span class="legend-line low"></span>
                      <span class="legend-text">Low availability</span>
                    </div>
                    <div class="legend-item">
                      <span class="legend-line best"></span>
                      <span class="legend-text">Best price</span>
                    </div>
                  </div>
                </div> -->
              <div class="session-navigation">
                <button type="button" 
                        class="nav-btn" 
                        (click)="prevSession()" 
                        [disabled]="!canGoPrevSession()">
                  â€¹
                </button>

                <div class="session-buttons">
                  <button type="button" 
                          class="session-btn" 
                          *ngFor="let session of getVisibleSessions()"
                          (click)="selectSession(session)"
                          [class.active]="selectedSession === session">
                    {{ session }}
                  </button>
                </div>

                <button type="button" 
                        class="nav-btn" 
                        (click)="nextSession()" 
                        [disabled]="!canGoNextSession()">
                  â€º
                </button>
              </div>
            </div>
          </div>

          <!-- Divider between calendar and tickets -->
          <div class="section-divider"></div>

          <!-- Ticket Selection -->
          <div class="ticket-selection">
            <div class="ticket-item available" *ngFor="let ticket of tickets">
              <div class="ticket-info">
                <h4 class="ticket-name">{{ ticket.name }}</h4>
                <span class="ticket-price">{{ ticket.price | currency:'USD':'symbol':'1.2-2' }}</span>
              </div>
              <div class="ticket-action">
                <div class="quantity-selector">
                  <button type="button" class="quantity-btn minus" (click)="adjustQuantity(ticket.id, -1)" [disabled]="getTicketQuantity(ticket.id) === 0">âˆ’</button>
                  <span class="quantity-display">{{ getTicketQuantity(ticket.id) }}</span>
                  <button type="button" class="quantity-btn plus" (click)="adjustQuantity(ticket.id, 1)">+</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Submit Button -->
          <button type="submit" class="book-button" [disabled]="!canBookTour()">
            {{ getTotalPrice() | currency:'USD':'symbol':'1.2-2' }} â€” Book Now
          </button>
        </form>
      </div>

      <!-- Notification Card - Below Booking Widget -->
      <div class="notification-card" *ngIf="showNotification">
        <div class="notification-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z" fill="#8B5CF6"/>
            <path d="M16 14L16.5 16.5L19 17L16.5 17.5L16 20L15.5 17.5L13 17L15.5 16.5L16 14Z" fill="#8B5CF6"/>
            <path d="M8 18L8.25 19.25L9.5 19.5L8.25 19.75L8 21L7.75 19.75L6.5 19.5L7.75 19.25L8 18Z" fill="#8B5CF6"/>
          </svg>
        </div>
        <div class="notification-content">
          <h3>Don't miss out!</h3>
          <p>Check available dates and tickets</p>
        </div>
        <button class="notification-btn" (click)="scrollToBooking()">Tickets</button>
      </div>
    </div>
  </div>
</div>