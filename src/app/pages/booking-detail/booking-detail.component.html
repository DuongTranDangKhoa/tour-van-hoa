<div class="booking-detail-page">
  <!-- Top Section: Tour Images -->
  <div class="tour-hero-section" *ngIf="tour" (click)="openImageGallery()">
    <div class="media-section">
      <!-- Left section - 50% -->
      <div class="main-image-section">
        <img [src]="tour.imageUrl" [alt]="tour.name" title="Tour image" class="hero-image">
        <button class="play-button">
          <i class="icon">‚ñ∂Ô∏è</i>
        </button>
      </div>
      
      <!-- Right section - 50% divided into 4 equal parts -->
      <div class="image-grid-section">
        <div class="grid-item">
          <img [src]="tour.imageUrl" [alt]="tour.name" title="Tour image">
          <div class="overlay-text">Tour Van Hoa presents</div>
        </div>
        <div class="grid-item top-right-border">
          <img [src]="tour.imageUrl" [alt]="tour.name" title="Tour image">
        </div>
        <div class="grid-item">
          <img [src]="tour.imageUrl" [alt]="tour.name" title="Tour image">
        </div>
        <div class="grid-item bot-right-border">
          <img [src]="tour.imageUrl" [alt]="tour.name" title="Tour image">
          <div class="gallery-btn">
            <i class="icon">üì∑</i>
            <span>Th∆∞ vi·ªán</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Ph·∫ßn d∆∞·ªõi: Chia 2 c·ªôt -->
  <div class="main-content" *ngIf="tour">
          <!-- Left Panel: Tour Information -->
    <div class="tour-details-panel">
      <div class="event-title-section">
        <h1>{{ tour.name }}</h1>
        <div class="rating">
          <i class="icon">‚≠ê</i>
          <i class="icon">‚≠ê</i>
          <i class="icon">‚≠ê</i>
          <i class="icon">‚≠ê</i>
          <i class="icon">‚≠ê</i>
          <span>(4.5)</span>
        </div>
      </div>
                        <div class="description-section">
          <h2>Description</h2>
          <div class="description-content">
            <div class="intro-section">
              <h3>Intro Description</h3>
              <p>‚ú® Step into the heart of Central Vietnam with the Vietnam Art & Culture Tour by This Is Home ‚Äî a full-day cultural journey designed to connect you with the country‚Äôs authentic heritage. From hands-on craft workshops to exploring the Cham Towers, every moment reveals the timeless beauty of Vietnam‚Äôs traditions. Guided by passionate locals, this immersive adventure blends creativity, cuisine, and community, leaving you with unforgettable memories of Vietnam‚Äôs soul.
              </p>
            </div>
            
            <div class="highlights-section">
              <h3>Highlights</h3>
              <div class="highlights-list">
                <p>üåø Authentic cultural immersion with local artisans.</p>
                <p>üè∫ Pottery-making at L√™ ƒê·ª©c H·∫° Pottery Village, including your own handmade souvenir.</p>
                <p>‚òï Hands-on coffee brewing workshop at Hush Coffee Workspace.</p>
                <p>ü™µ Wood carving experience at √Çu L·∫°c Workshop with master artisans.</p>
                <p>üç≤ Savor authentic Vietnamese cuisine with a traditional lunch.</p>
                <p>üèõ Explore the Cham Towers, learning about the Champa Kingdom‚Äôs art, history, and architecture.</p>
                <p>üéÅ Take home a cultural keepsake from your craft experience.</p>
              </div>
            </div>
            
            <div class="general-info-section">
              <h3>General Info</h3>
              <div class="general-info-list">
                <p>üìÖ Departure at 08:00 AM ‚Äì Return at 6:00 PM (full-day tour, approx. 10 hours).</p>
                <p>üìç Location: Pick-up & drop-off in ƒê√† N·∫µng</p>
                <p>üë®‚Äçüë©‚Äçüëß Age requirement: Suitable for all ages; children under 12 must be accompanied by an adult.</p>
                <p>üöå Transportation: Private coach (7-seater or 16-seater), air-conditioned.</p>
                <p>üí∞ Pricing Options (4 ticket types):</p>
                <p class="pricing-detail">Shared 7: $37/person (7-seater, up to 5 pax, shared with others, fixed meeting point).</p>
                <p class="pricing-detail">Shared 16: $37/person (16-seater, up to 14 pax, shared with others, fixed meeting point).</p>
                <p class="pricing-detail">Private 7: $305/tour (7-seater, up to 5 pax, hotel pick-up, private group).</p>
                <p class="pricing-detail">Private 16: $629/tour (16-seater, up to 14 pax, hotel pick-up, private group).</p>
                <p>üçΩ Meals included: 1 traditional Vietnamese lunch.</p>
                <p>üè® Accommodation: Not included (day tour only).</p>
                <p>‚ôø Accessibility: Wheelchair-friendly venues.</p>
                <p>‚úÖ Included: Entrance fees, English-speaking guides, all workshops, transportation, lunch, and keepsake.</p>
                <p>‚ùå Not included: Personal expenses, shopping, phone calls, additional drinks/meals, international flights.</p>
                <p>üì≤ Booking & Contact:</p>
                <p class="contact-detail">Website: tih.nhi.sg</p>
                <p class="contact-detail">Email: danh&#64;nhi.sg</p>
                <p class="contact-detail">WhatsApp: +84 367666618</p>
              </div>
            </div>
            
            <div class="full-description-section">
              <h3>Full Description</h3>
              <p>üå∏ This Is Home brings you a cultural journey to remember through Central Vietnam. Guided by local artisans and cultural experts, you‚Äôll experience:</p>
              <li class="pricing-detail">Pottery-making at L√™ ƒê·ª©c H·∫° Village, where Cham traditions meet Vietnamese craft.</li>
              <li class="pricing-detail">A hands-on coffee workshop at Hush Workspace, discovering the cultural roots of Vietnam‚Äôs coffee heritage.</li>
              <li class="pricing-detail">Wood carving at √Çu L·∫°c Workshop, learning how traditional art reflects history and spirituality.</li>
              <li class="pricing-detail">A visit to the Cham Towers in ƒê√† N·∫µng, where the architecture, art, and stories of the Champa Kingdom come alive.</li>
              <p>Along the way, enjoy a traditional Vietnamese lunch and take home a meaningful keepsake from your own craftwork.</p>
              <p>üå± Whether you‚Äôre a culture enthusiast, a family seeking meaningful bonding, or a traveler craving authentic encounters ‚Äî this tour promises lasting memories of Vietnam‚Äôs heritage and soul.</p>
            </div>
          </div>
        </div> 
      <div class="user-photo-gallery">
        <h2>User Photo Gallery</h2>
        <div class="photo-grid" (click)="openImageGallery()">
          <div class="photo-item">
            <img src="assets/minecraft-experience.jpg" alt="Minecraft Experience Screen">
            <div class="photo-overlay">
              <span class="photo-title">Minecraft Experience</span>
            </div>
          </div>
          <div class="photo-item">
            <img src="assets/minecraft-bee.jpg" alt="Minecraft Bee Statue">
            <div class="photo-overlay">
              <span class="photo-title">Minecraft Bee</span>
            </div>
          </div>
          <div class="photo-item">
            <img src="assets/minecraft-creeper.jpg" alt="Boy on Creeper Statue">
            <div class="photo-overlay">
              <span class="photo-title">Creeper Adventure</span>
            </div>
          </div>
          <div class="photo-item">
            <img src="assets/minecraft-structure.jpg" alt="Minecraft Blue Structure">
            <div class="photo-overlay">
              <span class="photo-title">Mysterious Structure</span>
            </div>
          </div>
        </div>
      </div>

      <div class="user-reviews-section" >
        <h2>User reviews</h2>
        <div class="reviews-header">
          <div class="score">
            <span class="score-value">4.8</span><span class="score-out-of">/5</span>
          </div>
          <div class="stars" aria-label="rating 5 stars">
            <i class="star">‚òÖ</i>
            <i class="star">‚òÖ</i>
            <i class="star">‚òÖ</i>
            <i class="star">‚òÖ</i>
            <i class="star">‚òÖ</i>
          </div>
          <div class="based-on">based on 29 reviews</div>
        </div>

        <div class="reviews-list">
          <div class="review-card">
            <div class="review-card-header">
              <div class="reviewer">Maechel D.</div>
              <div class="date">Jul 2025</div>
              <div class="stars small">
                <i>‚òÖ</i><i>‚òÖ</i><i>‚òÖ</i><i>‚òÖ</i><i>‚òÖ</i>
              </div>
            </div>
            <div class="review-text">
              Its magical and really breathless. The musical had really enjoying music, hope the time is more than one hour..
            </div>
          </div>

          <div class="review-card">
            <div class="review-card-header">
              <div class="reviewer">Alexandr...</div>
              <div class="date">Jul 2025</div>
              <div class="stars small">
                <i>‚òÖ</i><i>‚òÖ</i><i>‚òÖ</i><i>‚òÖ</i><i>‚òÖ</i>
              </div>
            </div>
            <div class="review-text">
              Very good and well organized. Great place and good music always match well.
            </div>
          </div>

          <div class="review-card">
            <div class="review-card-header">
              <div class="reviewer">Jun 2025</div>
              <div class="date">‚Äî</div>
              <div class="stars small">
                <i>‚òÖ</i><i>‚òÖ</i><i>‚òÖ</i><i>‚òÖ</i><i>‚òÖ</i>
              </div>
            </div>
            <div class="review-text">
              It was one of the most beautiful string concerts that I have ever gone to.
            </div>
          </div>
        </div>

        <div class="reviews-actions">
          <button type="button" class="view-all">View all reviews</button>
        </div>
      </div>
      <div class="map-and-info-section">
        <!-- Left Column: Info Sections -->
        <div class="info-column">
          <!-- Need Help Section -->
          <div class="help-section">
            <div class="info-header">
              <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="11" stroke="#333" stroke-width="1.5" fill="none"/>
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" stroke="#333" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="12" cy="17" r="1" fill="#333"/>
              </svg>
              <div class="info-content">
                <h3>Need help?</h3>
                <p>Contact Support <a href="#" class="link">here</a></p>
              </div>
            </div>
          </div>

          <!-- Getting There Section -->
          <div class="getting-there-section">
            <div class="info-header">
              <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <!-- Base -->
                <rect x="2" y="18" width="20" height="4" fill="#333"/>
                <!-- Columns -->
                <rect x="3" y="8" width="2" height="10" stroke="#333" stroke-width="1.5" fill="none"/>
                <rect x="7" y="8" width="2" height="10" stroke="#333" stroke-width="1.5" fill="none"/>
                <rect x="15" y="8" width="2" height="10" stroke="#333" stroke-width="1.5" fill="none"/>
                <rect x="19" y="8" width="2" height="10" stroke="#333" stroke-width="1.5" fill="none"/>
                <!-- Entablature -->
                <rect x="2" y="8" width="20" height="2" fill="#333"/>
                <!-- Roof/Pediment -->
                <path d="M2 8 L12 2 L22 8" stroke="#333" stroke-width="1.5" fill="none"/>
                <!-- Arch in pediment -->
                <path d="M8 6 Q12 4 16 6" stroke="#333" stroke-width="1" fill="none"/>
              </svg>
              <div class="info-content">
                <h3>About the venue</h3>
                <p class="address">
                  <span class="unit">VƒÉn Ph√≤ng NLT</span><br>
                  74 N·∫°i Nam, Ho√† C∆∞·ªùng B·∫Øc, H·∫£i Ch√¢u, ƒê√† N·∫µng, Vi·ªát Nam
                </p>
                <div class="location-tags">
                  <span class="tag grey"></span>
                  <span class="tag purple"></span>
                  <span class="location-name">Wembley Park</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Column: Google Map -->
        <div class="map-column">
          <div class="map-embed">
            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15338.392387180242!2d108.21975054258819!3d16.034423854237787!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x314219e4227c6aff%3A0xbbf3782d64ef714e!2zNzQgTuG6oWkgTmFtLCBIb8OgIEPGsOG7nW5nIELhuq9jLCBI4bqjaSBDaMOidSwgxJDDoCBO4bq1bmcsIFZp4buHdCBOYW0!5e0!3m2!1svi!2s!4v1756173936637!5m2!1svi!2s" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
          </div>
        </div>
      </div>
      
    </div>

    <!-- Right Panel: Booking Widget - feverup style -->
    <div class="booking-widget">
      <form [formGroup]="bookingForm" (ngSubmit)="onBookTour()">
        <!-- Calendar Section -->
        <div class="calendar-section">
          <h3>Ch·ªçn ng√†y v√† gi·ªù</h3>
          <div class="month-nav">
            <button type="button" (click)="prevMonth()" class="nav-btn" [disabled]="!canGoPrevMonth()">‚Äπ</button>
            
            <!-- Hi·ªÉn th·ªã 3 th√°ng -->
            <div class="month-buttons">
              <button type="button" 
                      *ngFor="let month of getVisibleMonths(); let i = index"
                      (click)="selectMonth(month.value, month.year)" 
                      [class.active]="month.value === currentMonth && month.year === currentYear"
                      class="month-btn">
                {{ month.label }}
              </button>
            </div>
            
            <button type="button" (click)="nextMonth()" class="nav-btn" [disabled]="!canGoNextMonth()">‚Ä∫</button>
          </div>

          <div class="weekdays">
            <div class="day">SU</div>
            <div class="day">MO</div>
            <div class="day">TU</div>
            <div class="day">WE</div>
            <div class="day">TH</div>
            <div class="day">FR</div>
            <div class="day">SA</div>
          </div>

          <div class="calendar-days">
            <div class="day-cell" *ngFor="let day of days" 
                 [class.selected]="day.selected"
                 [class.low-availability]="day.availability === 'low'"
                 [class.best-price]="day.availability === 'best'"
                 [class.empty]="!day.day"
                 [class.disabled]="day.disabled"
                 (click)="selectDate(day)">
              <div class="corner-ribbon" *ngIf="day.selected"></div>
              <div class="day-number">{{ day.day }}</div>
              <!-- <div class="day-price" *ngIf="day.day && !day.disabled">${{ day.price }}</div> -->
              <div class="bottom-indicator"></div>
            </div>
          </div>

          <!-- Session Selection -->
                      <div class="session-selection">
              <div class="session-header">
                <div class="currency-note">All prices shown in British pounds</div>
                <div class="legend">
                  <div class="legend-item">
                    <span class="legend-line low"></span>
                    <span class="legend-text">Low availability</span>
                  </div>
                  <div class="legend-item">
                    <span class="legend-line best"></span>
                    <span class="legend-text">Best price</span>
                  </div>
                </div>
              </div>
            <div class="session-navigation">
              <button type="button" 
                      class="nav-btn" 
                      (click)="prevSession()" 
                      [disabled]="!canGoPrevSession()">
                ‚Äπ
              </button>
              
              <div class="session-buttons">
                <button type="button" 
                        class="session-btn" 
                        *ngFor="let session of getVisibleSessions()"
                        (click)="selectSession(session)"
                        [class.active]="selectedSession === session">
                  {{ session }}
                </button>
              </div>
              
              <button type="button" 
                      class="nav-btn" 
                      (click)="nextSession()" 
                      [disabled]="!canGoNextSession()">
                ‚Ä∫
              </button>
            </div>
          </div>
        </div>

        <!-- Ticket Selection -->
        <div class="ticket-selection">
          <div class="ticket-item" *ngFor="let ticket of tickets">
            <div class="ticket-left">
              <div class="ticket-header">
                <h4>{{ ticket.name }}</h4>
             
              </div>
              <div class="ticket-desc">
                <button type="button" class="more-info-btn" (click)="toggleTicketInfo(ticket.id)">
                  {{ isTicketInfoVisible(ticket.id) ? 'Less info' : 'More info' }}
                </button>
                <div class="ticket-details" *ngIf="isTicketInfoVisible(ticket.id)">
                  <p>Ticket includes:</p>
                  <ul *ngIf="ticket.id === 'adult'">
                    <li>Shared coach, fixed itinerary</li>
                    <li>Arrival at the departure point before the tour starts</li>
                  </ul>
                  <ul *ngIf="ticket.id === 'child'">
                    <li>Must be accompanied by an adult</li>
                    <li>Shared coach, fixed itinerary</li>
                    <li>Arrival at the departure point before the tour starts</li>
                  </ul>
                  <ul *ngIf="ticket.id === 'small-group'">
                    <li></li>
                    <li>For groups of 3‚Äì5 guests</li>
                    <li>Private vehicle with hotel pick-up & drop-offted activities</li>
                    <li>Flexible itinerary: option to adjust or replace selected activities.</li>
                  </ul>
                  <ul *ngIf="ticket.id === 'large-group'">
                    <li>For groups of 6‚Äì14 guests</li>
                    <li>Private vehicle with hotel pick-up & drop-off</li>
                    <li>Customizable itinerary tailored to group preferences</li>
                  </ul>
                </div>
              </div>
              <div class="ticket-price">
                <span class="price">{{ ticket.price | currency:'USD':'symbol':'1.2-2' }}</span>
                <span class="fee" *ngIf="ticket.bookingFee > 0">+ {{ ticket.bookingFee | currency:'USD':'symbol':'1.2-2' }} booking fee</span>
              </div>
            </div>
            <div class="ticket-right">
              <div class="quantity-selector">
                <button type="button" (click)="adjustQuantity(ticket.id, -1)" [disabled]="getTicketQuantity(ticket.id) === 0">‚àí</button>
                <span>{{ getTicketQuantity(ticket.id) }}</span>
                <button type="button" (click)="adjustQuantity(ticket.id, 1)">+</button>
              </div>
            </div>
          </div>
    

          <!-- Total Price -->
          <div class="total-price">
            <span>Total:</span>
            <span class="amount">{{ getTotalPrice() | currency:'USD':'symbol':'1.2-2' }}</span>
          </div>

          <!-- Submit Button -->
          <button type="submit" class="book-button" [disabled]="isSubmitting || !selectedDate || !selectedSession">
            {{ getTotalPrice() | currency:'USD':'symbol':'1.2-2' }} ‚Äî Book Now
          </button>
        </div>
      </form>
    </div>
  </div>
</div>